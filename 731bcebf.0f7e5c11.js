(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{124:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return b}));var a=n(2),i=n(6),r=(n(0),n(155)),o={id:"hardyweinberg",title:"Hardy-Weinberg Equilibrium",sidebar_label:"Hardy-Weinberg Equilibrium"},c={id:"analyses/hardyweinberg",title:"Hardy-Weinberg Equilibrium",description:"Testing for Hardy-Weinberg Equilibrium (often abbreviated HWE) is a fairly common practice in population genetics. In a two-allele system, the HWE equation is defined as: p^2 + 2pq + q^2 = 1",source:"@site/docs/analyses/hardyweinberg.md",permalink:"/PopGen.jl/docs/analyses/hardyweinberg",editUrl:"https://github.com/pdimens/popgen.jl/edit/documentation/docs/analyses/hardyweinberg.md",sidebar_label:"Hardy-Weinberg Equilibrium",sidebar:"docs",previous:{title:"Viewing and sorting",permalink:"/PopGen.jl/docs/tutorials/viewsort"},next:{title:"Relatedness (Kinship)",permalink:"/PopGen.jl/docs/analyses/relatedness"}},l=[{value:"Chi-Squared Test",id:"chi-squared-test",children:[{value:"arguments",id:"arguments",children:[]},{value:"<code>correction</code> methods",id:"correction-methods",children:[]},{value:"example",id:"example",children:[]}]},{value:"Interpreting the results",id:"interpreting-the-results",children:[{value:"Visualizing the results",id:"visualizing-the-results",children:[]}]}],s={rightToc:l};function b(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Testing for Hardy-Weinberg Equilibrium (often abbreviated ",Object(r.b)("em",{parentName:"p"},"HWE"),") is a fairly common practice in population genetics. In a two-allele system, the HWE equation is defined as: p^2 + 2pq + q^2 = 1\nwhere $p$ is the frequency of the first allele and $q$ is the frequency of the second allele. The formula describes the frequency of all possible genotypes where"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"HWE variable"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Genotype"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"State"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"p^2"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),'"pp"'),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"homozygous")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"q^2"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),'"qq"'),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"homozygous")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"2pq"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),'"pq"'),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"heterozygous")))),Object(r.b)("p",null,"Testing for deviation from HWE is usually done with a Chi-Squared test, where one compares the observed genotype frequencies to the expected genotype frequencies given the observed allele frequencies at a locus. Specifically the equation is\n$$\\sum{\\frac{(observed - expected)^2}{expected}}$$\nwhere $observed$ is the observed genotype frequency and $expected$ is the expected genotype frequency for a locus. To generate our test statistic, we calculate the degrees of freedom:\n$$degrees\\ of\\ freedom = n",Object(r.b)("em",{parentName:"p"},"{expected\\ genotypes} - n"),"{observed\\ alleles}$$\nand use this as the parameter for our Chi Squared distribution, followed by a cumulative density function using this Chi Squared distribution and our Chi-Squared value calculated above."),Object(r.b)("h2",{id:"chi-squared-test"},"Chi-Squared Test"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-julia"}),'hwe_test(x::PopObj, by_pop::Bool = false, correction::String = "none")\n')),Object(r.b)("p",null,"Calculate chi-squared test of HWE for each locus and returns observed and expected heterozygosity with chi-squared, degrees of freedom and p-values for each locus. Use ",Object(r.b)("inlineCode",{parentName:"p"},"by_pop = true")," to perform this separately for each population (default: by_pop = false) and return a NamedTuple with the names corresponding to the population names. Use ",Object(r.b)("inlineCode",{parentName:"p"},"correction =")," to specify a P-value correction method for multiple testing (recommended). For convenience, the correction method is appended to the name of the column, so you will always know how those P-values were adjusted."),Object(r.b)("h3",{id:"arguments"},"arguments"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"x")," : the input ",Object(r.b)("inlineCode",{parentName:"li"},"PopObj")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"by_pop =")," : ",Object(r.b)("inlineCode",{parentName:"li"},"false")," (default) or ",Object(r.b)("inlineCode",{parentName:"li"},"true")," for hwe-by-population"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"correction ="),'  : a string specifying a P-value adjustment type (default: "none")')),Object(r.b)("h3",{id:"correction-methods"},Object(r.b)("inlineCode",{parentName:"h3"},"correction")," methods"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"bonferroni"')," : Bonferroni adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"holm"')," : Holm adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"hochberg"')," : Hochberg adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"bh"')," : Benjamini-Hochberg adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"by"')," : Benjamini-Yekutieli adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"bl"'),"  : Benjamini-Liu adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"hommel"')," : Hommel adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"sidak"')," : \u0160id\xe1k adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"forward stop"')," or ",Object(r.b)("inlineCode",{parentName:"li"},'"fs"')," : Forward-Stop adjustment"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},'"bc"')," : Barber-Cande\u0300s adjustment")),Object(r.b)("p",null,":thinking: For more information on multiple testing adjustments, see ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://juliangehring.github.io/MultipleTesting.jl/stable/"}),"MultipleTesting.jl")),Object(r.b)("h3",{id:"example"},"example"),Object(r.b)("p",null,":::: tabs card stretch\n::: tab HWE Chi-Squared"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'julia> hwe_test(gulfsharks())\nTable with 2213 rows, 4 columns:\nlocus           chisq      df  P\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n"contig_35208"  0.690979   3   0.875324\n"contig_23109"  1.71251    1   0.19066\n"contig_4493"   2.0785     1   0.149387\n"contig_10742"  0.249703   1   0.617284\n"contig_14898"  2.10859    1   0.146474\n"contig_8483"   0.019229   1   0.889712\n"contig_8065"   0.369866   1   0.543077\n"contig_14708"  0.213168   1   0.644295\n"contig_2307"   0.0447664  1   0.832434\n"contig_14564"  0.453808   1   0.500532\n\u22ee\n"contig_24711"  0.540694   1   0.462145\n"contig_18959"  0.968083   1   0.325159\n"contig_43517"  0.655517   1   0.418147\n"contig_27356"  1.71412    1   0.190451\n"contig_475"    0.0754715  1   0.783531\n"contig_19384"  2.10124    1   0.147179\n"contig_22368"  0.473923   1   0.491188\n"contig_2784"   0.0452162  1   0.831607\n')),Object(r.b)("p",null,":::\n::: tab HWE with P adjustment"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'julia> hwe_test(gulfsharks(), correction = "bh")\nTable with 2213 rows, 5 columns:\nlocus           chisq      df  P         P_bh\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n"contig_35208"  0.690979   3   0.875324  0.999911\n"contig_23109"  1.71251    1   0.19066   0.999911\n"contig_4493"   2.0785     1   0.149387  0.999911\n"contig_10742"  0.249703   1   0.617284  0.999911\n"contig_14898"  2.10859    1   0.146474  0.999911\n"contig_8483"   0.019229   1   0.889712  0.999911\n"contig_8065"   0.369866   1   0.543077  0.999911\n"contig_14708"  0.213168   1   0.644295  0.999911\n"contig_2307"   0.0447664  1   0.832434  0.999911\n"contig_14564"  0.453808   1   0.500532  0.999911\n\u22ee\n"contig_24711"  0.540694   1   0.462145  0.999911\n"contig_18959"  0.968083   1   0.325159  0.999911\n"contig_43517"  0.655517   1   0.418147  0.999911\n"contig_27356"  1.71412    1   0.190451  0.999911\n"contig_475"    0.0754715  1   0.783531  0.999911\n"contig_19384"  2.10124    1   0.147179  0.999911\n"contig_22368"  0.473923   1   0.491188  0.999911\n"contig_2784"   0.0452162  1   0.831607  0.999911\n')),Object(r.b)("p",null,":::\n::: tab HWE by population"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'julia> hwe_test(gulfsharks(), by_pop = true)\nTable with 15491 rows, 5 columns:\nlocus           population        chisq        df  P\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n"contig_35208"  "Florida Keys"    0.276208     3   0.964439\n"contig_35208"  "Cape Canaveral"  1.01787      1   0.313025\n"contig_35208"  "Mideast Gulf"    0.598475     1   0.439161\n"contig_35208"  "Georgia"         0.725926     1   0.394207\n"contig_35208"  "Northeast Gulf"  0.519382     3   0.914613\n"contig_35208"  "Southeast Gulf"  0.0888889    1   0.765594\n"contig_35208"  "South Carolina"  0.571429     1   0.449692\n"contig_23109"  "Florida Keys"    0.378698     1   0.538301\n"contig_23109"  "Cape Canaveral"  0.43618      1   0.508972\n"contig_23109"  "Mideast Gulf"    0.4032       1   0.525441\n\u22ee\n"contig_22368"  "South Carolina"  0.0092562    1   0.923354\n"contig_2784"   "Florida Keys"    0.0374777    1   0.846496\n"contig_2784"   "Cape Canaveral"  2.9277e-11   0   missing\n"contig_2784"   "Mideast Gulf"    0.0399408    1   0.841596\n"contig_2784"   "Georgia"         1.05242e-11  0   missing\n"contig_2784"   "Northeast Gulf"  1.47338e-11  0   missing\n"contig_2784"   "Southeast Gulf"  0.0138787    1   0.90622\n"contig_2784"   "South Carolina"  1.94026e-11  0   missing\n')),Object(r.b)("p",null,"When doing this test by population, you may notice some loci have ",Object(r.b)("inlineCode",{parentName:"p"},"missing")," P-values for certain populations, indicating that this locus is missing for that population. "),Object(r.b)("p",null,":::\n::::"),Object(r.b)("h2",{id:"interpreting-the-results"},"Interpreting the results"),Object(r.b)("p",null,"Since the results are in table form, you can easily process the table using ",Object(r.b)("inlineCode",{parentName:"p"},"JuliaDBMeta.jl")," or ",Object(r.b)("inlineCode",{parentName:"p"},"Query.jl")," to find loci above or below the alpha threshold you want. As an example, let's perform an HWE-test on the ",Object(r.b)("inlineCode",{parentName:"p"},"nancycats")," data without any P-value adjustments:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-julia"}),"julia> ncats_hwe = hwe_test(nancycats() ,by_pop = true) ;\n")),Object(r.b)("p",null,"Now, we can use ",Object(r.b)("inlineCode",{parentName:"p"},"DataFramesMeta")," to easily filter this table and leave only what we're interested in:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-julia"}),"using DataFramesMeta\n\njulia> @wher(ncats_hwe, :P .!= missing, :P .<= 0.05)\n")),Object(r.b)("p",null,"With this command, we invoke the ",Object(r.b)("inlineCode",{parentName:"p"},"@where")," filtering macro, then specify our ",Object(r.b)("inlineCode",{parentName:"p"},"ncats_hwe")," table, the ",Object(r.b)("inlineCode",{parentName:"p"},":P")," column of P-values, and then specify two filtering parameters: 1. the P-values are not ",Object(r.b)("inlineCode",{parentName:"p"},"missing"),", and (",Object(r.b)("inlineCode",{parentName:"p"},"&&"),") 2. the P-values are less than or equal to 0.05. Doing this results in a table that now only includes non-missing P-values of 0.05 or lower:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'Table with 46 rows, 5 columns:\nlocus    population  chisq    df  P\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n"fca8"   "2"         29.8624  15  0.0124275\n"fca8"   "3"         39.72    21  0.00804172\n"fca8"   "4"         64.3039  45  0.0308567\n"fca8"   "6"         34.0525  21  0.0357734\n"fca8"   "7"         37.6531  15  0.00101511\n"fca23"  "1"         26.0494  10  0.00367434\n"fca23"  "12"        35.5833  21  0.0243407\n"fca23"  "13"        30.3333  10  0.000755419\n"fca23"  "14"        49.7996  15  1.29835e-5\n\u22ee\n"fca90"  "9"         21.24    10  0.0194808\n"fca96"  "14"        58.0854  36  0.0112879\n"fca96"  "15"        26.51    15  0.0329918\n"fca96"  "2"         92.0716  15  4.06675e-13\n"fca37"  "1"         10.1562  3   0.0172836\n"fca37"  "3"         13.4815  6   0.0359962\n"fca37"  "5"         30.0206  6   3.89561e-5\n"fca37"  "8"         33.5111  21  0.0408481\n')),Object(r.b)("h3",{id:"visualizing-the-results"},"Visualizing the results"),Object(r.b)("p",null,"While not strictly necessary, it might sometimes make sense to generate of heatmap of the results for easier visualization. This is feasible for the ",Object(r.b)("inlineCode",{parentName:"p"},"nancycats")," data, but when loci are in the hundreds or thousands, this method quickly becomes counterproductive. In any case, here is a simple example of the HWE results for ",Object(r.b)("inlineCode",{parentName:"p"},"nancycats")," plotted as a heatmap using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/queryverse/VegaLite.jl"}),"VegaLite.jl"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-julia"}),'using VegaLite\n\njulia> ncats_hwe = hwe_test(nancycats() ,by_pop = true, correction = "bonferroni");\n\njulia> ncats |> @vlplot(:rect, :locus, :population, color=:P_bonferroni)\n')),Object(r.b)("p",null,Object(r.b)("img",Object(a.a)({parentName:"p"},{src:"../../img/hwe_test.png",alt:"hwe_test"}))))}b.isMDXComponent=!0},155:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=i.a.createContext({}),b=function(e){var t=i.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=b(e.components);return i.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},d=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=b(n),d=a,m=u["".concat(o,".").concat(d)]||u[d]||p[d]||r;return n?i.a.createElement(m,c(c({ref:t},s),{},{components:n})):i.a.createElement(m,c({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var s=2;s<r;s++)o[s]=n[s];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);